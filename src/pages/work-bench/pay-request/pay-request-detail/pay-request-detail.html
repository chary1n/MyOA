<!--
  Generated template for the PayRequestDetailPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>{{item.name}}</ion-title>
  </ion-navbar>

</ion-header>


<ion-content style="background:#f0f0f0">

  <ion-item style="height:70px;">
    <ion-grid style="background:white">
      <ion-row>
        <ion-col col-2>
          <img src={{item.create_person_ava}} class="imgHeard">
        </ion-col>
        <ion-col col-7 style="padding-top:18px">
          <span style="font-size:80%;">{{item.create_uid.name}}</span>
        </ion-col>
        <ion-col col-3 style="padding-top:18px">
          <span style="font-size:80%;color:#E0540E">{{changeState(item.state)}}</span>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-item>
  <ion-item no-lines>
      <div text-wrap style="float:right;font-size:80%;width:70%;color:gray"> {{item.parent_id.name}} </div>
      <div class="left_label" style="font-size:80%;width:30%"> 合作伙伴 </div>
    </ion-item>
  <ion-item no-lines>
    <div text-wrap style="float:right;font-size:80%;width:70%;color:gray"> {{item.bank_id.name}}</div>
    <div class="left_label" style="font-size:80%;width:30%"> 银行账户 </div>
  </ion-item>
  <ion-item no-lines>
    <div text-wrap style="float:right;font-size:80%;width:70%;color:gray">{{item.receive_date}}</div>
    <div class="left_label" style="font-size:80%;width:30%"> 付款日期 </div>
  </ion-item>
  <ion-item >
    <div text-wrap style="float:right;font-size:80%;width:70%;color:gray">{{item.remark}}</div>
    <div class="left_label" style="font-size:80%;width:30%"> 备注 </div>
  </ion-item>
  <ion-item no-lines>
    <div text-wrap style="float:right;font-size:80%;width:70%;color:#e0540e;text-align:right">申请金额：¥{{item.amount}}</div>
  </ion-item>
  <div style="margin:10px;font-size:13px;color:gray;">供应商对账单</div>
  <ion-list>
    <div *ngFor="let items of item.invoice_ids" style="margin-top:10px" tappable (click)="clickBillDetail(items)">
      <ion-item style="height:25px;min-height:35px;margin-top:3px;" no-lines>
        <div text-wrap style="float:right;font-size:80%;width:50%;color:#e0540e;text-align:right;margin-right:7px">{{getState(items)}}</div>
        <div class="left_label" style="font-size:80%;width:50%;">{{items.number}} </div>
      </ion-item> 
      <ion-item style="height:25px;min-height:25px;" no-lines>
        <div text-wrap style="float:right;font-size:80%;width:50%;color:gray;margin-top:-2px">源单据：{{items.origin}}</div>
        <div class="left_label" style="font-size:80%;width:50%;color:gray;margin-top:-2px">开票日期：{{items.date_invoice}}</div>
      </ion-item>
      <ion-item style="height:25px;min-height:25px;">
        <div text-wrap style="float:right;font-size:80%;width:50%;color:gray;margin-top:-2px">税金：{{items.tax}}</div>
        <div class="left_label" style="font-size:80%;width:50%;color:gray;margin-top:-2px">截止日期：{{items.date_due}}</div>
      </ion-item>
      <ion-item style="height:35px;min-height:35px" no-lines>
        <div text-wrap style="float:right;font-size:80%;width:50%;color:gray;text-align:center">待支付：¥{{fixTwo(items.amount_total_o)}}</div>
        <div class="left_label" style="font-size:80%;width:50%;text-align:center;color:gray"> 总计：¥{{fixTwo(items.amount_total)}} </div>
      </ion-item>
    </div>
  </ion-list>  

  <div style="font-size:13px;color:gray;margin:10px;margin-top:-10px">审批记录</div>
  <ion-list style="padding-bottom:30px;">
    <ion-item no-lines *ngFor='let items of item.message_ids' class="middle_item">
      <img item-start style="width:40px;" src={{items.create_person_ava}}>
      <div style="overflow:hidden">
        <span style="margin-top:3px;color:black;font-size:80%;float:left">{{items.create_person}}</span>

        <span style="font-size:70%;margin-top:5px;margin-left:-5px;float:right">{{changeDate(items.create_time)| date:'yyyy-MM-dd HH:mm:ss'}}</span>
      </div>
      <p *ngIf="items.old_state || items.new_state" style="font-size:80%;">{{items.old_state}}=>{{items.new_state}}</p>
      <p text-wrap style="font-size:80%;">{{items.description}}</p>
    </ion-item>
  </ion-list>
</ion-content>

<ion-footer *ngIf = "isShowFooter">
  <div *ngIf = "this.item.state == 'manager' && this.power" style="background:#f0f0f0">
    <button round ion-start style='width:40%;margin-left:5%; background-color:red' ion-button (click)="cancel()">
      拒绝
    </button>
    <button ion-end round style='width:40%;float:right;margin-right:5%;background-color:#1eabfe' ion-button
      (click)="conform()">
      通过
    </button>
  </div>

  <div *ngIf = "this.item.state == 'posted'" style="background:#f0f0f0">
    <button round ion-start style='width:40%;margin-left:5%; background-color:red' ion-button (click)="cancel()">
      拒绝
    </button>
    <button ion-end round style='width:40%;float:right;margin-right:5%;background-color:#1eabfe' ion-button
      (click)="send_manager()">
      送审经理
    </button>
  </div>
</ion-footer>
